"use strict";(self.webpackChunkcouchbase_haystack=self.webpackChunkcouchbase_haystack||[]).push([[605],{5711:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>a});var i=r(4848),s=r(8453);const c={id:"document_filter",title:"DocumentFilter"},l="Couchbase Filter and Query Utilities",t={id:"reference/document_filter",title:"DocumentFilter",description:"This module provides utilities for handling and normalizing filters and queries for use with Couchbase's search capabilities, specifically tailored for integration with the Haystack framework. The utilities include custom classes and functions to handle date range and numeric range queries, as well as functions to normalize filters into Couchbase-compatible search queries.",source:"@site/docs/reference/document_filter.md",sourceDirName:"reference",slug:"/reference/document_filter",permalink:"/reference/document_filter",draft:!1,unlisted:!1,editUrl:"https://github.com/Couchbase-Ecosystem/couchbase-haystack/docs/reference/document_filter.md",tags:[],version:"current",frontMatter:{id:"document_filter",title:"DocumentFilter"},sidebar:"tutorialSidebar",previous:{title:"CouchbaseDocumentStore",permalink:"/reference/couchbase_document_store"},next:{title:"ClusterOptions",permalink:"/reference/cluster_options"}},o={},a=[{value:"Class Overview",id:"class-overview",level:2},{value:"<code>DateRangeQuery</code>",id:"daterangequery",level:3},{value:"Properties",id:"properties",level:4},{value:"<code>NumericRangeQuery</code>",id:"numericrangequery",level:3},{value:"Properties",id:"properties-1",level:4},{value:"Function Overview",id:"function-overview",level:2},{value:"<code>_normalize_filters</code>",id:"_normalize_filters",level:3},{value:"<code>_parse_logical_condition</code>",id:"_parse_logical_condition",level:3},{value:"<code>_parse_comparison_condition</code>",id:"_parse_comparison_condition",level:3},{value:"<code>create_search_query</code>",id:"create_search_query",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"couchbase-filter-and-query-utilities",children:"Couchbase Filter and Query Utilities"})}),"\n",(0,i.jsx)(n.p,{children:"This module provides utilities for handling and normalizing filters and queries for use with Couchbase's search capabilities, specifically tailored for integration with the Haystack framework. The utilities include custom classes and functions to handle date range and numeric range queries, as well as functions to normalize filters into Couchbase-compatible search queries."}),"\n",(0,i.jsx)(n.h2,{id:"class-overview",children:"Class Overview"}),"\n",(0,i.jsx)(n.h3,{id:"daterangequery",children:(0,i.jsx)(n.code,{children:"DateRangeQuery"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"DateRangeQuery"})," class extends Couchbase's ",(0,i.jsx)(n.code,{children:"DateRangeQuery"})," to provide additional properties for inclusive start and end dates."]}),"\n",(0,i.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inclusive_start"})," (Optional[bool]): Indicates whether the start of the date range is inclusive."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inclusive_end"})," (Optional[bool]): Indicates whether the end of the date range is inclusive."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'date_query = DateRangeQuery(start="2024-01-01T00:00:00Z", end="2024-12-31T23:59:59Z", field="created_at")\ndate_query.inclusive_start = True\ndate_query.inclusive_end = True\n'})}),"\n",(0,i.jsx)(n.h3,{id:"numericrangequery",children:(0,i.jsx)(n.code,{children:"NumericRangeQuery"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"NumericRangeQuery"})," class extends Couchbase's ",(0,i.jsx)(n.code,{children:"NumericRangeQuery"})," to provide additional properties for inclusive minimum and maximum values."]}),"\n",(0,i.jsx)(n.h4,{id:"properties-1",children:"Properties"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inclusive_min"})," (Optional[bool]): Indicates whether the minimum value is inclusive."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"inclusive_max"})," (Optional[bool]): Indicates whether the maximum value is inclusive."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'numeric_query = NumericRangeQuery(min=10, max=100, field="price")\nnumeric_query.inclusive_min = True\nnumeric_query.inclusive_max = True\n'})}),"\n",(0,i.jsx)(n.h2,{id:"function-overview",children:"Function Overview"}),"\n",(0,i.jsx)(n.h3,{id:"_normalize_filters",children:(0,i.jsx)(n.code,{children:"_normalize_filters"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def _normalize_filters(filters: Dict[str, Any]) -> SearchQuery\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Converts Haystack-style filters into Couchbase-compatible search queries."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Input Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"filters"})," (Dict[str, Any]): A dictionary representing the filters to be normalized."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns a ",(0,i.jsx)(n.code,{children:"SearchQuery"})," object that can be used in Couchbase search operations."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Raises:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FilterError"}),": If the filters provided are not in the expected format."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'filters = {\n    "operator": "AND",\n    "conditions": [\n        {"field": "price", "operator": ">=", "value": 10},\n        {"field": "created_at", "operator": "<=", "value": "2024-12-31T23:59:59Z"}\n    ]\n}\nsearch_query = _normalize_filters(filters)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"_parse_logical_condition",children:(0,i.jsx)(n.code,{children:"_parse_logical_condition"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def _parse_logical_condition(condition: Dict[str, Any]) -> SearchQuery\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Parses a logical condition (AND, OR, NOT) into a Couchbase ",(0,i.jsx)(n.code,{children:"SearchQuery"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Input Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"condition"})," (Dict[str, Any]): A dictionary representing the logical condition."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns a ",(0,i.jsx)(n.code,{children:"SearchQuery"})," object that represents the logical condition."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'logical_condition = {\n    "operator": "AND",\n    "conditions": [\n        {"field": "status", "operator": "==", "value": "active"},\n        {"field": "price", "operator": "<", "value": 50}\n    ]\n}\nsearch_query = _parse_logical_condition(logical_condition)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"_parse_comparison_condition",children:(0,i.jsx)(n.code,{children:"_parse_comparison_condition"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def _parse_comparison_condition(condition: Dict[str, Any]) -> Dict[str, Any]\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Parses a comparison condition (e.g., ",(0,i.jsx)(n.code,{children:"=="}),", ",(0,i.jsx)(n.code,{children:">"}),", ",(0,i.jsx)(n.code,{children:"<="}),") into a Couchbase ",(0,i.jsx)(n.code,{children:"SearchQuery"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Input Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"condition"})," (Dict[str, Any]): A dictionary representing the comparison condition."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns a ",(0,i.jsx)(n.code,{children:"SearchQuery"})," object that represents the comparison condition."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Raises:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FilterError"}),": If the condition is not properly formatted or contains unsupported types."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'comparison_condition = {\n    "field": "created_at",\n    "operator": ">=",\n    "value": "2024-01-01T00:00:00Z"\n}\nsearch_query = _parse_comparison_condition(comparison_condition)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"create_search_query",children:(0,i.jsx)(n.code,{children:"create_search_query"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def create_search_query(field: str, value: Any) -> SearchQuery\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Creates a Couchbase ",(0,i.jsx)(n.code,{children:"SearchQuery"})," based on the field and value provided."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Input Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"field"})," (str): The name of the field to query."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"value"})," (Any): The value to query for. Can be a number, date, or string."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns a ",(0,i.jsx)(n.code,{children:"SearchQuery"})," object that matches the field and value provided."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Usage:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'search_query = create_search_query("price", 25)\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>t});var i=r(6540);const s={},c=i.createContext(s);function l(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);